<!DOCTYPE html>
<html>
<head>
 
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ä½¿ç”¨ dotfiles å’Œ stow ç®¡ç†ä½ çš„ dotfiles</title>
<meta name="generator" content="Org-mode">
<meta name="author" content="æ¬§é˜³ç»§è¶…">

<link rel="apple-touch-icon" sizes="114x114" href="https://blog.oyanglul.us/assets/apple-icon-114x114.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="manifest" href="https://blog.oyanglul.us/assets/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="alternate" type="application/rss+xml" title="Jichao Ouyang" href="http://blog.oyanglul.us/index.xml">

<!--[if lt IE 9]>
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.ie.min.css" />
     <![endif]-->



<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>
<body>
<div id="org-div-home-and-up">
<a accesskey="h" href="https://blog.oyanglul.us/index.html"> UP </a>
|
<a accesskey="H" href="https://blog.oyanglul.us/~jichao.ouyang.html"> HOME </a>
</div><div id="content">
<header>
<h1 class="title">ä½¿ç”¨ dotfiles å’Œ stow ç®¡ç†ä½ çš„ dotfiles</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">ä½¿ç”¨ stow ç®¡ç† symlink</a>
<ul>
<li><a href="#orgheadline2">stow æ–‡ä»¶</a></li>
<li><a href="#orgheadline3">stow ç›®å½•</a></li>
</ul>
</li>
<li><a href="#orgheadline4">push to github</a></li>
<li><a href="#orgheadline5">submodule vs subtree</a></li>
<li><a href="#orgheadline6">ãŠ™ Sensitive dotfiles</a></li>
</ul>
</div>
</nav>
<p>
å¯èƒ½çœ‹æ ‡é¢˜ä½ è§‰å¾—æˆ‘ç–¯äº†ï¼Œä»€ä¹ˆå«ç”¨ dotfiles ç®¡ç†ä½ çš„ dotfilesã€‚
</p>
<p>
ç¬¬ä¸€ä¸ªå•è¯ <a href="http://dotfiles.github.io/">dotfiles</a> æŒ‡å°† HOME ç›®å½•ä¸‹çš„ <code>.XXX</code> (å®ƒä»¬æ˜¯çœŸçš„å­—é¢æ„æ€dotfiles) æ–‡ä»¶åŒæ­¥åˆ° Github ä¸Šçš„æ–¹å¼ã€‚
é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­è£…çš„å¤§éƒ¨åˆ†å·¥å…·ï¼Œéƒ½ä¼šåœ¨ HOME ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªä»¥ <code>.</code> å¼€å¤´çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œæ”¾ç½®é…ç½®æˆ–è€…çŠ¶æ€ã€‚
</p>
<p>
å› æ­¤æˆ‘ä»¬å¸Œæœ›çš„æ˜¯ç”¨ github ç‰ˆæœ¬ç®¡ç†è¿™äº› <b>é…ç½®</b> ï¼Œè€Œä¸æ˜¯ <b>çŠ¶æ€</b> ã€‚
</p>
<blockquote>
<p>
ä¸‹é¢ä¾‹å­ä¸­çš„ dotfiles repo åœ¨<a href="https://github.com/jcouyang/dotfiles">è¿™é‡Œ</a>
</p>
</blockquote>
<p>
å¥½å§ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹åˆ°åº•å¦‚ä½•ç‰ˆæœ¬ç®¡ç†è¿™äº› â€œdotfilesâ€ã€‚
</p>
<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1">ä½¿ç”¨ stow ç®¡ç† symlink</h2>
<div class="outline-text-2" id="text-orgheadline1">
<p>
GNU stow æ˜¯ç®¡ç†ç¬¦å·é“¾æ¥ï¼ˆsymlinkï¼‰çš„ä¸€ä¸ªå°å…¬ä¸¾ã€‚åªéœ€è¦
</p>
<div class="org-src-container">
<pre class="src src-shell-script">brew install stow
</pre>
</div>
<p>
æˆ–è€…å¦‚æœä½ é mac æœºå™¨ï¼Œè¯·è®¿é—®<a href="http://www.gnu.org/software/stow/">å®˜ç½‘</a>çœ‹çœ‹å¦‚ä½•å®‰è£…
</p>
<p>
å®‰è£…äº† stow ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ symlink ä¸€äº› dotfiles äº†ã€‚ä»¥ fish å’Œ omf ä¸ºä¾‹ï¼Œå®ƒä»¬æœ¬æ¥çš„ HOME ç›®å½•ä¸‹
çš„ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š
</p>
<pre class="example"><span class="linenr">1: </span>â‹Š&gt; ~/dotfiles on master â¨¯ tree ~/.config                                             22:25:34
<span class="linenr">2: </span>/Users/jcouyang/.config
<span class="linenr">3: </span>â”œâ”€â”€ fish
<span class="linenr">4: </span>â”‚&nbsp;&nbsp; â”œâ”€â”€ config.fish
<span class="linenr">5: </span>â”‚&nbsp;&nbsp; â”œâ”€â”€ fish_history
<span class="linenr">6: </span>â”‚&nbsp;&nbsp; â””â”€â”€ fishd.a45e60d0d7e3
<span class="linenr">7: </span>â””â”€â”€ omf
<span class="linenr">8: </span>    â”œâ”€â”€ bundle
<span class="linenr">9: </span>    â””â”€â”€ theme
</pre>
</div>
<div id="outline-container-orgheadline2" class="outline-3">
<h3 id="orgheadline2">stow æ–‡ä»¶</h3>
<div class="outline-text-3" id="text-orgheadline2">
<p>
æ³¨æ„çœ‹æˆ‘ä»¬éœ€è¦ç‰ˆæœ¬ç®¡ç†æ–‡ä»¶åº”è¯¥æ˜¯ config.fish å’Œ omf ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œäºæ˜¯ï¼Œæˆ‘å°†è¿™äº›æ–‡ä»¶è€ƒåˆ°æˆ‘æ–°å»º
çš„ <code>~/dotfiles</code> ç›®å½•ä¸‹
</p>
<pre class="example">mkdir ~/dotfiles/
cd ~/dotfiles
mkdir -p fish/.config/fish
mv ~/.config/fish/config.fish fish/.config/fish/
ls fish/.config/fish/
</pre>
<p>
ç°åœ¨å¯ä»¥ä½¿ç”¨ stow åˆ›å»º symlink äº†ã€‚
</p>
<div class="org-src-container">
<pre class="src src-shell-script">stow fish
</pre>
</div>
<p>
ç…ç… ç°åœ¨ <code>~/.config</code> å˜ä»€ä¹ˆæ ·äº†
</p>
<pre class="example">â‹Š&gt; ~/dotfiles on master â¨¯ tree ~/.config                                             22:33:55
/Users/jcouyang/.config
â”œâ”€â”€ fish
â”‚&nbsp;&nbsp; â”œâ”€â”€ config.fish -&gt; ../../dotfiles/fish/.config/fish/config.fish
â”‚&nbsp;&nbsp; â”œâ”€â”€ fish_history
â”‚&nbsp;&nbsp; â””â”€â”€ fishd.a45e60d0d7e3
</pre>
<p>
<code>config.fish</code> è¢«é“¾åˆ°äº†æˆ‘åˆ›å»ºçš„ <code>dotfiles/fish</code> åº•ä¸‹åŒæ ·çš„ç›®å½•ä¸­ã€‚ é‡è¦çš„æ˜¯ä¸¤ä¸ªçŠ¶æ€æ–‡ä»¶ <code>fish_history</code> å’Œ
<code>fish.blahblah</code> ä»»ç„¶åœ¨ <code>~/.config/fish</code> ä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³è¦ä»–ä»¬åˆ°æˆ‘ä»¬çš„ dotfiles ä¸­æ¥ã€‚
</p>
<p>
äºæ˜¯ï¼Œè¿™æ ·å…¶å®æ¯æ¬¡ä¿®æ”¹ <code>config.fish</code> éƒ½å®é™…ä¸Šæ˜¯åœ¨ä¿®æ”¹ <code>~/dotfiles</code> ä¸‹çš„ <code>config.fish</code>
</p>
</div>
</div>
<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3">stow ç›®å½•</h3>
<div class="outline-text-3" id="text-orgheadline3">
<p>
å¦å¤–æˆ‘ä»¬åœ¨è¯•è¯•ç®¡ç† omf(oh-my-fish)ï¼Œä¼¼ä¹ omfä¸‹é¢æ²¡æœ‰ä»€ä¹ˆçŠ¶æ€ï¼Œbundle å’Œ theme éƒ½æ˜¯é…ç½®ï¼Œæ‰€ä»¥
ä¸å…¶ symlink æ–‡ä»¶ï¼Œä¸å¦‚ symlink æ•´ä¸ª omf ç›®å½•ã€‚åŒæ ·åœ¨ <code>~/dotfiles</code> ç›®å½•ä¸‹è¿è¡Œ
</p>
<pre class="example">mkdir -p ~/dotfiles/omf/.config
mv ~/.config/omf ~/dotfiles/omf/.config/omf
stow omf
</pre>
<p>
è¿™æ—¶å€™å†çœ‹çœ‹ <code>~/.config</code>
</p>
<pre class="example">/Users/jcouyang/.config
â”œâ”€â”€ fish
â”‚&nbsp;&nbsp; â”œâ”€â”€ config.fish -&gt; ../../dotfiles/fish/.config/fish/config.fish
â”‚&nbsp;&nbsp; â”œâ”€â”€ fish_history
â”‚&nbsp;&nbsp; â””â”€â”€ fishd.a45e60d0d7e3
â””â”€â”€ omf -&gt; ../dotfiles/omf/.config/omf
</pre>
<p>
æˆ‘ä»¬æŠŠæ•´ä¸ª omf ç›®å½•éƒ½é“¾åˆ°äº† dotfile ç›®å½•ä¸‹
</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4">push to github</h2>
<div class="outline-text-2" id="text-orgheadline4">
<p>
ä¸‹é¢çœ‹å¦‚ä½•ç”¨ github æ¥ç®¡ç†è¿™äº› dotfiles
</p>
<p>
å¼ºçƒˆæ¨èå…ˆå®‰è£… <a href="http://hub.github.com/">hub</a>
</p>
<div class="org-src-container">
<pre class="src src-shell-script">brew install hub
hub create dotfiles
git add .
git commit -m <span style="color: rgb(139, 0, 0);">"my awesome dotfiles"</span>
git push origin master
</pre>
</div>
<p>
å°±è¿™ä¹ˆç®€å•ï¼Œä½ çš„é…ç½®æ–‡ä»¶å°±å®‰å…¨çš„æ”¾åˆ°äº† github ä¸Šï¼Œå¹¶ä¸”ä»¥åæ¯ä¸€æ¬¡æ”¹åŠ¨éƒ½å†ä¹Ÿä¸æ€•æ”¹æŒ‚äº†ã€‚
</p>
</div>
</div>
<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5">submodule vs subtree</h2>
<div class="outline-text-2" id="text-orgheadline5">
<p>
ä½†æ˜¯æˆ‘æœ‰äº›é…ç½®æ–‡ä»¶å…¶å®åœ¨å¦å¤–ä¸€ä¸ª repo ä¸Šï¼Œè¿™æ—¶å€™æˆ‘æ€ä¹ˆèƒ½è·Ÿè¿™ä¸ª <code>dotfiles</code> repo åˆåˆ°ä¸€èµ·å‘¢ï¼Ÿ
</p>
<p>
æ¯”å¦‚<a href="https://github.com/jcouyang/.emacs.d">æˆ‘çš„ emacs é…ç½®æ–‡ä»¶</a>ï¼Œå…¶å®æ˜¯å•ç‹¬ç®¡ç†åœ¨å¦ä¸€ repo çš„ã€‚
</p>
<p>
è¿™æ—¶å€™ git ä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§æ–¹å¼æ¥ç®¡ç† submodule å’Œ subtreeã€‚ æˆ‘ç”¨çš„æ˜¯åä¸€ç§ï¼Œè‡³äº submodule
ä¸ºä»€ä¹ˆä¸é€‚ç”¨ï¼Œç½‘ä¸Šæœ‰<a href="http://blogs.atlassian.com/2013/05/alternatives-to-git-submodule-git-subtree/">å¤§é‡æ–‡ç« </a>è§£é‡Šï¼Œæˆ‘å°±æ‡’å¾—ç¿»è¯‘äº†ã€‚
</p>
<div class="org-src-container">
<pre class="src src-shell-script">â‹Š&gt; ~/dotfiles on master â¨¯ git subtree add --prefix emacs/.emacs.d git@github.com:jcouyang/.emacs.d.git master --squash
</pre>
</div>
<p>
è¿™è¡Œ subtree å‘½ä»¤æŠŠæˆ‘çš„ emacs é…ç½®ä»æˆ‘çš„ repo ä¸‹ä¸‹æ¥ä½œä¸º subtreeï¼Œå¹¶ squash(åˆæˆä¸€ä¸ª) commits
</p>
<p>
è¿™æ—¶æˆ‘çš„ gitæ ‘æ˜¯è¿™æ ·çš„
</p>
<pre class="example">\* commit b33c46bfebe4a28849aa967222555a4676fdb9f4 (HEAD -&gt; master)
|\  Merge: 1b240f8 e6dacdc
| | Author: Jichao Ouyang &lt;oyanglulu@gmail.com&gt;
| | Date:   Thu Oct 29 21:33:06 2015 +0800
| |
| |     Merge commit 'e6dacdcd1f85cdcb3b5fa488edb7b8f31c297b3f' as 'emacs/.emacs.d'
| |
| * commit e6dacdcd1f85cdcb3b5fa488edb7b8f31c297b3f
</pre>
<p>
å¯ä»¥çœ‹è§æŠŠ æˆ‘çš„ emacs repo merge äº†è¿›æ¥ï¼Œè¿™æ ·å°±è·Ÿåœ¨ <code>dotfiles</code> repo çš„ä»£ç ä¸€æ ·ï¼Œè¯¥ commit çš„ commit è¯¥
push çš„ pushã€‚
</p>
<p>
ä¸‹é¢çœ‹å¦‚ä½• push å›æˆ‘çš„ emacs repoã€‚
</p>
<p>
æ¯”å¦‚æˆ‘ç°åœ¨å¯¹ subtree emacs åšäº†æ”¹åŠ¨å¹¶ commit äº†ã€‚ç„¶å
</p>
<pre class="example">git remote add emacs git@github.com:jcouyang/.emacs.d.git
git subtree push --prefix emacs/.emacs.d emacs master
</pre>
<ol class="org-ol">
<li>å…ˆæŠŠ emacs çš„ repo åŠ åˆ°æˆ‘çš„ remote é‡Œï¼Œç»™ä¸ªåå­— emacs</li>
<li>ç”¨ subtree push ç›´æ¥ push åˆ° remote emacsï¼Œbranch master</li>
</ol>
</div>
</div>
<div id="outline-container-orgheadline6" class="outline-2">
<h2 id="orgheadline6">ãŠ™ Sensitive dotfiles</h2>
<div class="outline-text-2" id="text-orgheadline6">
<p>
æœ‰äº› dotfiles ä¸­å¯èƒ½æ¶‰åŠä¸€äº› token æˆ–è€…å¯†ç ï¼Œå¦‚æœæŠŠä»–ä»¬ push åˆ° public çš„ github ä¸Šï¼Œ <del>æœ‰å¯èƒ½</del> è‚¯å®šä¼šå¯¹ä½ ä¸ªäººæˆ–è€…å…¬å¸é€ æˆå·¨å¤§çš„æŸå¤±ï¼ˆæœ€è¿‘å…¬å¸å°±å¼€å§‹æ‰«æä¸ªäºº github è´¦æˆ·äº†ğŸ™€ å¥½ç´§å¼ ï¼‰ã€‚äºæ˜¯æˆ‘ä»¬éœ€è¦å¯¹è¿™äº›æ•æ„Ÿçš„ dotfiles åšåŠ å¯†ã€‚
</p>
<p>
æ¯”å¦‚ <code>~/.config/hub</code> é‡Œé¢ï¼Œæœ‰æˆ‘å’Œå…¬å¸çš„ github çš„ tokenï¼Œæˆ‘å¯ä¸åƒè¿™ç©æ„è¢«å¼„åˆ° github ä¸Šã€‚
</p>
<p>
ç›®å‰æœ€å¹¿æ³›ä½¿ç”¨çš„åŠ å¯†æ‰‹æ®µæ˜¯ Gnupgï¼Œç®€ç§° gpgï¼Œä¸€æ ·ä½¿ç”¨ brew è£…å°±å¥½äº†
</p>
<div class="org-src-container">
<pre class="src src-sh">brew install gnupg
</pre>
</div>
<p>
å®‰è£…å®Œä¹‹åéœ€è¦ç”Ÿæˆä¸€ä¸ª keypair
</p>
<div class="org-src-container">
<pre class="src src-sh">gpg --gen-key
</pre>
</div>
<p>
è¾“å…¥åå­—ï¼Œé‚®ç®±ï¼Œå¯†ç ä¹‹åï¼Œå°± ok äº†
</p>
<p>
ç„¶åå‘¢ï¼Œæˆ‘å¹¶ä¸å¸Œæœ›æ‰‹åŠ¨çš„æ¯æ¬¡åŠ å¯†å®Œå†push åˆ°æˆ‘çš„ç§æœ‰ git ä¸Šï¼ˆå¯¹ï¼Œå³ä½¿æ˜¯ç§æœ‰ gitï¼Œå®‰å…¨è€ƒè™‘æˆ‘è¿˜æ˜¯éœ€è¦åŠ å¯†ï¼Œç»å¯¹ä¸èƒ½æ˜æ–‡å­˜å‚¨ï¼Œå°±æ˜¯è¿™ä¹ˆä»»æ€§ï¼‰ã€‚
</p>
<p>
é‚£ä¹ˆåˆ°åº•å»å“ªå¼„ä¸€ä¸ªç§æœ‰ git å‘¢ï¼Ÿå¦‚æœæ²¡æœ‰ï¼Œdropbox å°±å¯ä»¥ï¼Œç„¶åç°åœ¨çš„é—®é¢˜æ˜¯å¦‚ä½•åœ¨ push çš„æ—¶å€™è‡ªåŠ¨çš„ gpg åŠ å¯†ã€‚
</p>
<p>
ç°åœ¨ git remote crypt å¤§æ³•å°±è¯¥ç™»åœºäº†ï¼Œåˆ°è¿™é‡Œ <a href="https://github.com/joeyh/git-remote-gcrypt">https://github.com/joeyh/git-remote-gcrypt</a> æŠŠ repo ä¸‹ä¸‹æ¥æ‰§è¡Œ <code>./install.sh</code>, ä¹‹åå°±åº”è¯¥æœ‰ <code>git-remote-gcrypt</code> è¿™æ ·ä¸€ä¸ªå‘½ä»¤ï¼Œå…ˆåˆ«è·‘
</p>
<p>
å…³é”®åœ¨äºè§ remote çš„æ—¶å€™ã€‚å½“æˆ‘åœ¨ home ç›®å½•å»ºäº†ä¸€ä¸ª <code>dotfiles-private</code> çš„æ–‡ä»¶å¤¹ï¼Œstow å®Œå„ç§æ•æ„Ÿ dotfiles ä¹‹å
</p>
<div class="org-src-container">
<pre class="src src-sh">git init
git add .
git commit -m <span style="color: rgb(139, 0, 0);">"some private dotfiles"</span>
git remote add dropbox gcrypt::rsync:///Users/jcouyang/Dropbox/dotfiles-private.git
git push
</pre>
</div>
<p>
ä½ ä¼šè¢«é—®åˆ°åˆšæ‰åˆ›å»º gpg keypair æ—¶è¾“å…¥çš„å¯†ç ï¼Œç„¶åâ€¦
</p>
<p>
çœ‹ï¼Œä¸¤å¨ gpg åŠ å¯†è¿‡çš„æ–‡ä»¶
<img src="image.png" alt="image.png">
</p>
<p>
<b>LLAP ğŸ––</b>
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p>Author: æ¬§é˜³ç»§è¶… <iframe src="index_1.html" style="width: 160px; height: 20px; border: medium none;" allowtransparency="true" scrolling="no" frameborder="0"></iframe></p>
<p>Modified: 2016-07-24 Sun 14:12</p>
<p>Generated by: <a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.1 (<a href="http://orgmode.org/">Org</a> mode 8.3.5)</p>
<p>&lt;Publish&gt; with _(:Ğ·ã€âˆ )_ by <a href="https://github.com/jcouyang/orgpress">OrgPress</a></p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/"><img alt="Creative Commons License" style="border-width: 0px;" src="88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License</a>.
<p class="org-center">
<input class="st-default-search-input" placeholder="Search" type="swiftype">
</p>
<p><a href="https://blog.oyanglul.us/index.xml">RSS</a> | <a href="https://blog.oyanglul.us/archive.html">ARCHIVE</a> | <a href="https://blog.oyanglul.us/theindex.html">INDEX</a> | <a href="#" id="edit-in-github">EDIT</a></p>
<a class="github-fork-ribbon right-bottom fixed" href="https://github.com/jcouyang/blog" title="Fork me on GitHub">Fork me on GitHub</a>

 



 
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-6604550863422842" data-ad-slot="7967742338" data-ad-format="auto"></ins>

 
<div id="disqus_thread"></div>


 

</div>


</body>
</html>
