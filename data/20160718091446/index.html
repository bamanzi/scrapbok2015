<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="zh-CN" xml:lang="zh-CN" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Active Support 核心扩展 — Ruby on Rails 指南</title>








<link href="favicon.ico" rel="shortcut icon" type="image/x-icon">

<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>
<body class="guide"><div id="container"><div class="wrapper"><div id="mainCol"><!--DOCUMENT_FRAGMENT--><h3 id="extensions-to-numeric">Extensions to <code>Numeric</code>
</h3><h4 id="bytes">6.1 Bytes</h4><p>All numbers respond to these methods:</p><div class="code_container">
<div><div id="highlighter_510846" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">bytes</code></div><div class="line number2 index1 alt1"><code class="ruby plain">kilobytes</code></div><div class="line number3 index2 alt2"><code class="ruby plain">megabytes</code></div><div class="line number4 index3 alt1"><code class="ruby plain">gigabytes</code></div><div class="line number5 index4 alt2"><code class="ruby plain">terabytes</code></div><div class="line number6 index5 alt1"><code class="ruby plain">petabytes</code></div><div class="line number7 index6 alt2"><code class="ruby plain">exabytes</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>They return the corresponding amount of bytes, using a conversion factor of 1024:</p><div class="code_container">
<div><div id="highlighter_457306" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">2</code><code class="ruby plain">.kilobytes&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 2048</code></div><div class="line number2 index1 alt1"><code class="ruby constants">3</code><code class="ruby plain">.megabytes&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 3145728</code></div><div class="line number3 index2 alt2"><code class="ruby constants">3</code><code class="ruby plain">.</code><code class="ruby constants">5</code><code class="ruby plain">.gigabytes </code><code class="ruby comments"># =&gt; 3758096384</code></div><div class="line number4 index3 alt1"><code class="ruby plain">-</code><code class="ruby constants">4</code><code class="ruby plain">.exabytes&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; -4611686018427387904</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Singular forms are aliased so you are able to say:</p><div class="code_container">
<div><div id="highlighter_733421" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">1</code><code class="ruby plain">.megabyte </code><code class="ruby comments"># =&gt; 1048576</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>定义于 <code>active_support/core_ext/numeric/bytes.rb</code>.</p></div><h4 id="time">6.2 Time</h4><p>Enables the use of time calculations and declarations, like <code>45.minutes + 2.hours + 4.years</code>.</p><p>These methods use Time#advance for precise date calculations when using from_now, ago, etc.
as well as adding or subtracting their results from a Time object. For example:</p><div class="code_container">
<div><div id="highlighter_802701" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># equivalent to Time.current.advance(months: 1)</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1</code><code class="ruby plain">.month.from_now</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby comments"># equivalent to Time.current.advance(years: 2)</code></div><div class="line number5 index4 alt2"><code class="ruby constants">2</code><code class="ruby plain">.years.from_now</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="ruby comments"># equivalent to Time.current.advance(months: 4, years: 5)</code></div><div class="line number8 index7 alt1"><code class="ruby plain">(</code><code class="ruby constants">4</code><code class="ruby plain">.months + </code><code class="ruby constants">5</code><code class="ruby plain">.years).from_now</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>While these methods provide precise calculation when used as in the examples above, care
should be taken to note that this is not true if the result of <code>months',</code>years', etc is
converted before use:</p><div class="code_container">
<div><div id="highlighter_36137" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># equivalent to 30.days.to_i.from_now</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1</code><code class="ruby plain">.month.to_i.from_now</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby comments"># equivalent to 365.25.days.to_f.from_now</code></div><div class="line number5 index4 alt2"><code class="ruby constants">1</code><code class="ruby plain">.year.to_f.from_now</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>In such cases, Ruby's core <a href="http://ruby-doc.org/stdlib/libdoc/date/rdoc/Date.html">Date</a> and
<a href="http://ruby-doc.org/stdlib/libdoc/time/rdoc/Time.html">Time</a> should be used for precision
date and time arithmetic.</p><div class="note"><p>定义于 <code>active_support/core_ext/numeric/time.rb</code>.</p></div><h4 id="formatting">6.3 Formatting</h4><p>Enables the formatting of numbers in a variety of ways.</p><p>Produce a string representation of a number as a telephone number:</p><div class="code_container">
<div><div id="highlighter_823448" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">5551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; 555-1234</code></div><div class="line number3 index2 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">)</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; 123-555-1234</code></div><div class="line number5 index4 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">, area_code: </code><code class="ruby keyword">true</code><code class="ruby plain">)</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt; (123) 555-1234</code></div><div class="line number7 index6 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">, delimiter: </code><code class="ruby string">" "</code><code class="ruby plain">)</code></div><div class="line number8 index7 alt1"><code class="ruby comments"># =&gt; 123 555 1234</code></div><div class="line number9 index8 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">, area_code: </code><code class="ruby keyword">true</code><code class="ruby plain">, extension: </code><code class="ruby constants">555</code><code class="ruby plain">)</code></div><div class="line number10 index9 alt1"><code class="ruby comments"># =&gt; (123) 555-1234 x 555</code></div><div class="line number11 index10 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">, country_code: </code><code class="ruby constants">1</code><code class="ruby plain">)</code></div><div class="line number12 index11 alt1"><code class="ruby comments"># =&gt; +1-123-555-1234</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number as currency:</p><div class="code_container">
<div><div id="highlighter_378937" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">1234567890</code><code class="ruby plain">.</code><code class="ruby constants">50</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:currency</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; $1,234,567,890.50</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1234567890</code><code class="ruby plain">.</code><code class="ruby constants">506</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:currency</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; $1,234,567,890.51</code></div><div class="line number3 index2 alt2"><code class="ruby constants">1234567890</code><code class="ruby plain">.</code><code class="ruby constants">506</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:currency</code><code class="ruby plain">, precision: </code><code class="ruby constants">3</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; $1,234,567,890.506</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number as a percentage:</p><div class="code_container">
<div><div id="highlighter_275466" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">100</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:percentage</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; 100.000%</code></div><div class="line number3 index2 alt2"><code class="ruby constants">100</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:percentage</code><code class="ruby plain">, precision: </code><code class="ruby constants">0</code><code class="ruby plain">)</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; 100%</code></div><div class="line number5 index4 alt2"><code class="ruby constants">1000</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:percentage</code><code class="ruby plain">, delimiter: </code><code class="ruby string">'.'</code><code class="ruby plain">, separator: </code><code class="ruby string">','</code><code class="ruby plain">)</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt; 1.000,000%</code></div><div class="line number7 index6 alt2"><code class="ruby constants">302</code><code class="ruby plain">.</code><code class="ruby constants">24398923423</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:percentage</code><code class="ruby plain">, precision: </code><code class="ruby constants">5</code><code class="ruby plain">)</code></div><div class="line number8 index7 alt1"><code class="ruby comments"># =&gt; 302.24399%</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number in delimited form:</p><div class="code_container">
<div><div id="highlighter_687286" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">12345678</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12,345,678</code></div><div class="line number2 index1 alt1"><code class="ruby constants">12345678</code><code class="ruby plain">.</code><code class="ruby constants">05</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12,345,678.05</code></div><div class="line number3 index2 alt2"><code class="ruby constants">12345678</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">, delimiter: </code><code class="ruby string">"."</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12.345.678</code></div><div class="line number4 index3 alt1"><code class="ruby constants">12345678</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">, delimiter: </code><code class="ruby string">","</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12,345,678</code></div><div class="line number5 index4 alt2"><code class="ruby constants">12345678</code><code class="ruby plain">.</code><code class="ruby constants">05</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">, separator: </code><code class="ruby string">" "</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; 12,345,678 05</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number rounded to a precision:</p><div class="code_container">
<div><div id="highlighter_150108" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">111</code><code class="ruby plain">.</code><code class="ruby constants">2345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 111.235</code></div><div class="line number2 index1 alt1"><code class="ruby constants">111</code><code class="ruby plain">.</code><code class="ruby constants">2345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">, precision: </code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 111.23</code></div><div class="line number3 index2 alt2"><code class="ruby constants">13</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">, precision: </code><code class="ruby constants">5</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 13.00000</code></div><div class="line number4 index3 alt1"><code class="ruby constants">389</code><code class="ruby plain">.</code><code class="ruby constants">32314</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">, precision: </code><code class="ruby constants">0</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 389</code></div><div class="line number5 index4 alt2"><code class="ruby constants">111</code><code class="ruby plain">.</code><code class="ruby constants">2345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">, significant: </code><code class="ruby keyword">true</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; 111</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number as a human-readable number of bytes:</p><div class="code_container">
<div><div id="highlighter_515357" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">123</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 123 Bytes</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 1.21 KB</code></div><div class="line number3 index2 alt2"><code class="ruby constants">12345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12.1 KB</code></div><div class="line number4 index3 alt1"><code class="ruby constants">1234567</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 1.18 MB</code></div><div class="line number5 index4 alt2"><code class="ruby constants">1234567890</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 1.15 GB</code></div><div class="line number6 index5 alt1"><code class="ruby constants">1234567890123</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; 1.12 TB</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number in human-readable words:</p><div class="code_container">
<div><div id="highlighter_510501" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">123</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "123"</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Thousand"</code></div><div class="line number3 index2 alt2"><code class="ruby constants">12345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "12.3 Thousand"</code></div><div class="line number4 index3 alt1"><code class="ruby constants">1234567</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Million"</code></div><div class="line number5 index4 alt2"><code class="ruby constants">1234567890</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Billion"</code></div><div class="line number6 index5 alt1"><code class="ruby constants">1234567890123</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Trillion"</code></div><div class="line number7 index6 alt2"><code class="ruby constants">1234567890123456</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Quadrillion"</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>定义于 <code>active_support/core_ext/numeric/conversions.rb</code>.</p></div><!--/DOCUMENT_FRAGMENT--></div></div></div></body>
</html>
