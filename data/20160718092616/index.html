<!DOCTYPE html>
<html lang="en" class="">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
    <meta charset="UTF-8">

    
    
    
    
    
    
    

    <link as="script" href="https://assets-cdn.github.com/assets/frameworks-35477f5e4824848c27a44f62e3cd3b009cc9fbedf6074ddd8765ee70d09499c6.js" rel="preload">
    
    <link as="script" href="https://assets-cdn.github.com/assets/github-121e6c09bb508b99e99c9fb1d41a3b377c131efae6cf3423f6ca2b3492ed4b3b.js" rel="preload">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta name="viewport" content="width=device-width">
    
    
    <title>metaprogramming-ruby/2.2-Dynamic-Methods.markdown at master · elite28/metaprogramming-ruby</title>
    <link rel="search" type="application/opensearchdescription+xml" href="https://github.com/opensearch.xml" title="GitHub">
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <link rel="apple-touch-icon" href="https://github.com/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="57x57" href="https://github.com/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://github.com/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://github.com/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://github.com/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://github.com/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://github.com/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://github.com/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://github.com/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://github.com/apple-touch-icon-180x180.png">
    <meta property="fb:app_id" content="1401488693436528">

      <meta content="https://avatars3.githubusercontent.com/u/347701?v=3&amp;s=400" name="twitter:image:src"><meta content="@github" name="twitter:site"><meta content="summary" name="twitter:card"><meta content="elite28/metaprogramming-ruby" name="twitter:title"><meta content="metaprogramming-ruby - translate metaprogramming ruby" name="twitter:description">
      <meta content="https://avatars3.githubusercontent.com/u/347701?v=3&amp;s=400" property="og:image"><meta content="GitHub" property="og:site_name"><meta content="object" property="og:type"><meta content="elite28/metaprogramming-ruby" property="og:title"><meta content="https://github.com/elite28/metaprogramming-ruby" property="og:url"><meta content="metaprogramming-ruby - translate metaprogramming ruby" property="og:description">
      <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">
    <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">
    <link rel="assets" href="https://assets-cdn.github.com/">
    <link rel="web-socket" href="wss://live.github.com/_sockets/Nzc1ODY3OjYyYTY2ZmZhMGI5MTg2MzUwNWU5OTBjMDFhNGIwMDE1OmVkYWU4NmIwNmY4NTk2MTI2MGZjM2FmYWMwZjNiMzc5ZTg1Mzc4YTE4Yzg5MGM1NjFmMjU1MjA3ODkxZTIzMWY=--b5eacf1241695fdd9d37e48394ff53e3b6a0d5a7">
    <meta name="pjax-timeout" content="1000">
    <link rel="sudo-modal" href="https://github.com/sessions/sudo_modal">

    <meta name="msapplication-TileImage" content="/windows-tile.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    

    <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
<meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-analytics" content="UA-3769691-2">

<meta content="collector.githubapp.com" name="octolytics-host"><meta content="github" name="octolytics-app-id"><meta content="75884F80:2D36E:4EFC876:578C2F59" name="octolytics-dimension-request_id"><meta content="775867" name="octolytics-actor-id"><meta content="bamanzi" name="octolytics-actor-login"><meta content="e1253ee97109340dbe6750e67f37cd50634b775c85ce81905686b977ca0464a6" name="octolytics-actor-hash">




  <meta class="js-ga-set" name="dimension1" content="Logged In">



        <meta name="hostname" content="github.com">
    <meta name="user-login" content="bamanzi">

        <meta name="expected-hostname" content="github.com">
      <meta name="js-proxy-site-detection-payload" content="ZmE5OTJjODBjZjJjZDI3YjhkMzczYjFjYTUxNjFiZmIyOTA1Y2ZlNDc3NmIzZDU1Yzc0Mjk1Y2NlNGViMWZmYnx7InJlbW90ZV9hZGRyZXNzIjoiMTE3LjEzNi43OS4xMjgiLCJyZXF1ZXN0X2lkIjoiNzU4ODRGODA6MkQzNkU6NEVGQzg3Njo1NzhDMkY1OSIsInRpbWVzdGFtcCI6MTQ2ODgwNDk1NH0=">


      <link rel="mask-icon" href="https://assets-cdn.github.com/pinned-octocat.svg" color="#4078c0">
      <link rel="icon" type="image/x-icon" href="favicon.ico">

    <meta name="html-safe-nonce" content="9bc6031c5c1839e039b5149459eaa3d47140a792">
    <meta content="84da46a5ca5dc665232f8b3d18ab77c9d7b5d735" name="form-nonce">

    <meta http-equiv="x-pjax-version" content="843306541653655d87637353a377dafa">
    

      
  <meta name="description" content="metaprogramming-ruby - translate metaprogramming ruby">
  <meta name="go-import" content="github.com/elite28/metaprogramming-ruby git https://github.com/elite28/metaprogramming-ruby.git">

  <meta content="347701" name="octolytics-dimension-user_id"><meta content="elite28" name="octolytics-dimension-user_login"><meta content="1640276" name="octolytics-dimension-repository_id"><meta content="elite28/metaprogramming-ruby" name="octolytics-dimension-repository_nwo"><meta content="true" name="octolytics-dimension-repository_public"><meta content="false" name="octolytics-dimension-repository_is_fork"><meta content="1640276" name="octolytics-dimension-repository_network_root_id"><meta content="elite28/metaprogramming-ruby" name="octolytics-dimension-repository_network_root_nwo">
  <link href="https://github.com/elite28/metaprogramming-ruby/commits/master.atom" rel="alternate" title="Recent Commits to metaprogramming-ruby:master" type="application/atom+xml">


      
  <meta data-pjax-transient="true" name="selected-link" value="repo_source"><meta content="/<user-name>/<repo-name>/blob/show" data-pjax-transient="true" name="analytics-location"><link rel="canonical" href="https://github.com/elite28/metaprogramming-ruby/blob/master/zh/02-metaprogramming-ruby/02-Tuesday-Methods/2.2-Dynamic-Methods.markdown" data-pjax-transient="true"><link data-pjax-transient="true" href="https://github.com/elite28/metaprogramming-ruby/commits/master.atom" rel="alternate" title="Recent Commits to metaprogramming-ruby:master" type="application/atom+xml">
<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>


  <body class="logged-in   env-production linux vis-public">
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div style="width: 100%;" class="progress"></div></div>
    <a href="#start-of-content" tabindex="1" class="accessibility-aid js-skip-to-content">Skip to content</a>

    
    
    



        <div class="header header-logged-in true" role="banner">
  <div class="container clearfix">

    <a class="header-logo-invertocat" href="https://github.com/" data-hotkey="g d" aria-label="Homepage" data-ga-click="Header, go to dashboard, icon:logo">
  <svg aria-hidden="true" class="octicon octicon-mark-github" height="28" version="1.1" viewBox="0 0 16 16" width="28"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>


        <div class="header-search scoped-search site-scoped-search js-site-search" role="search">
  <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="https://github.com/elite28/metaprogramming-ruby/search" class="js-site-search-form" data-scoped-search-url="/elite28/metaprogramming-ruby/search" data-unscoped-search-url="/search" method="get"><div style="margin: 0px; padding: 0px; display: inline;"><input name="utf8" value="✓" type="hidden"></div>
    <label class="form-control header-search-wrapper js-chromeless-input-container">
      <div class="header-search-scope">This repository</div>
      <input class="form-control header-search-input js-site-search-focus js-site-search-field is-clearable" data-hotkey="s" name="q" placeholder="Search" aria-label="Search this repository" data-unscoped-placeholder="Search GitHub" data-scoped-placeholder="Search" tabindex="1" autocapitalize="off" type="text">
    </label>
</form></div>


      <ul class="header-nav left" role="navigation">
        <li class="header-nav-item">
          <a href="https://github.com/pulls" class="js-selected-navigation-item header-nav-link" data-ga-click="Header, click, Nav menu - item:pulls context:user" data-hotkey="g p" data-selected-links="/pulls /pulls/assigned /pulls/mentioned /pulls">
            Pull requests
</a>        </li>
        <li class="header-nav-item">
          <a href="https://github.com/issues" class="js-selected-navigation-item header-nav-link" data-ga-click="Header, click, Nav menu - item:issues context:user" data-hotkey="g i" data-selected-links="/issues /issues/assigned /issues/mentioned /issues">
            Issues
</a>        </li>
          <li class="header-nav-item">
            <a class="header-nav-link" href="https://gist.github.com/" data-ga-click="Header, go to gist, text:gist">Gist</a>
          </li>
      </ul>

    
<ul class="header-nav user-nav right" id="user-links">
  <li class="header-nav-item">
    
    <a href="https://github.com/notifications" aria-label="You have unread notifications" class="header-nav-link notification-indicator tooltipped tooltipped-s js-socket-channel js-notification-indicator" data-channel="tenant:1:notification-changed:775867" data-ga-click="Header, go to notifications, icon:unread" data-hotkey="g n">
        <span class="mail-status unread"></span>
        <svg aria-hidden="true" class="octicon octicon-bell" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M14 12v1H0v-1l.73-.58c.77-.77.81-2.55 1.19-4.42C2.69 3.23 6 2 6 2c0-.55.45-1 1-1s1 .45 1 1c0 0 3.39 1.23 4.16 5 .38 1.88.42 3.66 1.19 4.42l.66.58H14zm-7 4c1.11 0 2-.89 2-2H5c0 1.11.89 2 2 2z"></path></svg>
</a>
  </li>

  <li class="header-nav-item dropdown js-menu-container">
    <a class="header-nav-link tooltipped tooltipped-s js-menu-target" href="https://github.com/new" aria-label="Create new…" data-ga-click="Header, create new, icon:add">
      <svg aria-hidden="true" class="octicon octicon-plus left" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 9H7v5H5V9H0V7h5V2h2v5h5z"></path></svg>
      <span class="dropdown-caret"></span>
    </a>

    <div class="dropdown-menu-content js-menu-content">
      <ul class="dropdown-menu dropdown-menu-sw">
        
<a class="dropdown-item" href="https://github.com/new" data-ga-click="Header, create new repository">
  New repository
</a>

  <a class="dropdown-item" href="https://github.com/new/import" data-ga-click="Header, import a repository">
    Import repository
  </a>


  <a class="dropdown-item" href="https://github.com/organizations/new" data-ga-click="Header, create new organization">
    New organization
  </a>




      </ul>
    </div>
  </li>

  <li class="header-nav-item dropdown js-menu-container">
    <a class="header-nav-link name tooltipped tooltipped-sw js-menu-target" href="https://github.com/bamanzi" aria-label="View profile and more" data-ga-click="Header, show menu, icon:avatar">
      <img alt="@bamanzi" class="avatar" src="775867.dat" width="20" height="20">
      <span class="dropdown-caret"></span>
    </a>

    <div class="dropdown-menu-content js-menu-content">
      <div class="dropdown-menu dropdown-menu-sw">
        <div class="dropdown-header header-nav-current-user css-truncate">
          Signed in as <strong class="css-truncate-target">bamanzi</strong>
        </div>

        <div class="dropdown-divider"></div>

        <a class="dropdown-item" href="https://github.com/bamanzi" data-ga-click="Header, go to profile, text:your profile">
          Your profile
        </a>
        <a class="dropdown-item" href="https://github.com/stars" data-ga-click="Header, go to starred repos, text:your stars">
          Your stars
        </a>
        <a class="dropdown-item" href="https://github.com/explore" data-ga-click="Header, go to explore, text:explore">
          Explore
        </a>
          <a class="dropdown-item" href="https://github.com/integrations" data-ga-click="Header, go to integrations, text:integrations">
            Integrations
          </a>
        <a class="dropdown-item" href="https://help.github.com/" data-ga-click="Header, go to help, text:help">
          Help
        </a>


        <div class="dropdown-divider"></div>

        <a class="dropdown-item" href="https://github.com/settings/profile" data-ga-click="Header, go to settings, icon:settings">
          Settings
        </a>

        <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="https://github.com/logout" class="logout-form" data-form-nonce="84da46a5ca5dc665232f8b3d18ab77c9d7b5d735" method="post"><div style="margin: 0px; padding: 0px; display: inline;"><input name="utf8" value="✓" type="hidden"><input name="authenticity_token" value="vQxDbK8JRYx4xDCUA2Q/VjJhpNwiheCXnNfAeDB+jGF5rRmLkxwiVs//uN29s66wi9XBt7GI6xhQJjIyQwfCwg==" type="hidden"></div>
          <button class="dropdown-item dropdown-signout" data-ga-click="Header, sign out, icon:logout">
            Sign out
          </button>
</form>      </div>
    </div>
  </li>
</ul>


    
  </div>
</div>


      


    <div id="start-of-content" class="accessibility-aid"></div>

      <div id="js-flash-container">
</div>


    <div role="main">
        <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode">
    <div id="js-repo-pjax-container" data-pjax-container=""><div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav">
  <div class="container repohead-details-container">

    

<ul class="pagehead-actions">

  <li>
        <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="https://github.com/notifications/subscribe" class="js-social-container" data-autosubmit="true" data-form-nonce="84da46a5ca5dc665232f8b3d18ab77c9d7b5d735" data-remote="true" method="post"><div style="margin: 0px; padding: 0px; display: inline;"><input name="utf8" value="✓" type="hidden"><input name="authenticity_token" value="i2GriPTEl5x5KlWlYE2pUbwBegOOm04LkpbtqHyUAwXhLcF73D3OrWffP7lrT2Zy4r3Jm8/sxV2ihrCi9HM5wQ==" type="hidden"></div>      <input class="form-control" id="repository_id" name="repository_id" value="1640276" type="hidden">

        <div class="select-menu js-menu-container js-select-menu">
          <a href="https://github.com/elite28/metaprogramming-ruby/subscription" class="btn btn-sm btn-with-count select-menu-button js-menu-target" role="button" tabindex="0" aria-haspopup="true" data-ga-click="Repository, click Watch settings, action:blob#show">
            <span class="js-select-button">
              <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
              Watch
            </span>
          </a>
          <a class="social-count js-social-count" href="https://github.com/elite28/metaprogramming-ruby/watchers">
            1
          </a>

        <div class="select-menu-modal-holder">
          <div class="select-menu-modal subscription-menu-modal js-menu-content" aria-hidden="true">
            <div class="select-menu-header js-navigation-enable" tabindex="-1">
              <svg aria-label="Close" class="octicon octicon-x js-menu-close" height="16" role="img" version="1.1" viewBox="0 0 12 16" width="12"><path d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"></path></svg>
              <span class="select-menu-title">Notifications</span>
            </div>

              <div class="select-menu-list js-navigation-container" role="menu">

                <div class="select-menu-item js-navigation-item selected" role="menuitem" tabindex="0">
                  <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z"></path></svg>
                  <div class="select-menu-item-text">
                    <input checked="checked" id="do_included" name="do" value="included" type="radio">
                    <span class="select-menu-item-heading">Not watching</span>
                    <span class="description">Be notified when participating or @mentioned.</span>
                    <span class="js-select-button-text hidden-select-button-text">
                      <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                      Watch
                    </span>
                  </div>
                </div>

                <div class="select-menu-item js-navigation-item " role="menuitem" tabindex="0">
                  <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z"></path></svg>
                  <div class="select-menu-item-text">
                    <input id="do_subscribed" name="do" value="subscribed" type="radio">
                    <span class="select-menu-item-heading">Watching</span>
                    <span class="description">Be notified of all conversations.</span>
                    <span class="js-select-button-text hidden-select-button-text">
                      <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                      Unwatch
                    </span>
                  </div>
                </div>

                <div class="select-menu-item js-navigation-item " role="menuitem" tabindex="0">
                  <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z"></path></svg>
                  <div class="select-menu-item-text">
                    <input id="do_ignore" name="do" value="ignore" type="radio">
                    <span class="select-menu-item-heading">Ignoring</span>
                    <span class="description">Never be notified.</span>
                    <span class="js-select-button-text hidden-select-button-text">
                      <svg aria-hidden="true" class="octicon octicon-mute" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"></path></svg>
                      Stop ignoring
                    </span>
                  </div>
                </div>

              </div>

            </div>
          </div>
        </div>
</form>
  </li>

  <li>
    
  <div class="js-toggler-container js-social-container starring-container on">

    <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="https://github.com/elite28/metaprogramming-ruby/unstar" class="starred" data-form-nonce="84da46a5ca5dc665232f8b3d18ab77c9d7b5d735" data-remote="true" method="post"><div style="margin: 0px; padding: 0px; display: inline;"><input name="utf8" value="✓" type="hidden"><input name="authenticity_token" value="B0cDghwYMG/BoMOec41FzVNE6eyv1uezt6jCvNjqeqkQh/CMEn9xpJSL16leT4fbaTwtcnEEEq6BHQtPjeCtkA==" type="hidden"></div>
      <button class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Unstar elite28/metaprogramming-ruby" data-ga-click="Repository, click unstar button, action:blob#show; text:Unstar">
        <svg aria-hidden="true" class="octicon octicon-star" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74z"></path></svg>
        Unstar
      </button>
        <a class="social-count js-social-count" href="https://github.com/elite28/metaprogramming-ruby/stargazers">
          5
        </a>
</form>
    <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="https://github.com/elite28/metaprogramming-ruby/star" class="unstarred" data-form-nonce="84da46a5ca5dc665232f8b3d18ab77c9d7b5d735" data-remote="true" method="post"><div style="margin: 0px; padding: 0px; display: inline;"><input name="utf8" value="✓" type="hidden"><input name="authenticity_token" value="EvCSXt7pa7jLI05NczQyJBOMme2Tn9L1c0hBauUmzJVozbilcmYFKHqa8Z3rzrffPtTJeWqbuolKiyisTEydPg==" type="hidden"></div>
      <button class="btn btn-sm btn-with-count js-toggler-target" aria-label="Star this repository" title="Star elite28/metaprogramming-ruby" data-ga-click="Repository, click star button, action:blob#show; text:Star">
        <svg aria-hidden="true" class="octicon octicon-star" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74z"></path></svg>
        Star
      </button>
        <a class="social-count js-social-count" href="https://github.com/elite28/metaprogramming-ruby/stargazers">
          5
        </a>
</form>  </div>

  </li>

  <li>
          <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="https://github.com/elite28/metaprogramming-ruby/fork" class="btn-with-count" data-form-nonce="84da46a5ca5dc665232f8b3d18ab77c9d7b5d735" method="post"><div style="margin: 0px; padding: 0px; display: inline;"><input name="utf8" value="✓" type="hidden"><input name="authenticity_token" value="IHlF52COgOb0aqAphIfx5MyWIkXr8WV9jQCINtDgRyqAqx5SEETEI9AgBaAIc0o4Kwy471gdc5JSWAdo3/XRPQ==" type="hidden"></div>
            <button type="submit" class="btn btn-sm btn-with-count" data-ga-click="Repository, show fork modal, action:blob#show; text:Fork" title="Fork your own copy of elite28/metaprogramming-ruby to your account" aria-label="Fork your own copy of elite28/metaprogramming-ruby to your account">
              <svg aria-hidden="true" class="octicon octicon-repo-forked" height="16" version="1.1" viewBox="0 0 10 16" width="10"><path d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
              Fork
            </button>
</form>
    <a href="https://github.com/elite28/metaprogramming-ruby/network" class="social-count">
      1
    </a>
  </li>
</ul>

    <h1 class="public ">
  <svg aria-hidden="true" class="octicon octicon-repo" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
  <span class="author" itemprop="author"><a href="https://github.com/elite28" class="url fn" rel="author">elite28</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a href="https://github.com/elite28/metaprogramming-ruby" data-pjax="#js-repo-pjax-container">metaprogramming-ruby</a></strong>

</h1>

  </div>
  <div class="container">
    
<nav class="reponav js-repo-nav js-sidenav-container-pjax" itemscope="" itemtype="http://schema.org/BreadcrumbList" role="navigation" data-pjax="#js-repo-pjax-container">

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a href="https://github.com/elite28/metaprogramming-ruby" aria-selected="true" class="js-selected-navigation-item reponav-item selected" data-hotkey="g c" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches /elite28/metaprogramming-ruby" itemprop="url">
      <svg aria-hidden="true" class="octicon octicon-code" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"></path></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>


  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a href="https://github.com/elite28/metaprogramming-ruby/pulls" class="js-selected-navigation-item reponav-item" data-hotkey="g p" data-selected-links="repo_pulls /elite28/metaprogramming-ruby/pulls" itemprop="url">
      <svg aria-hidden="true" class="octicon octicon-git-pull-request" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
      <span itemprop="name">Pull requests</span>
      <span class="counter">0</span>
      <meta itemprop="position" content="3">
</a>  </span>

    <a href="https://github.com/elite28/metaprogramming-ruby/wiki" class="js-selected-navigation-item reponav-item" data-hotkey="g w" data-selected-links="repo_wiki /elite28/metaprogramming-ruby/wiki">
      <svg aria-hidden="true" class="octicon octicon-book" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z"></path></svg>
      Wiki
</a>

  <a href="https://github.com/elite28/metaprogramming-ruby/pulse" class="js-selected-navigation-item reponav-item" data-selected-links="pulse /elite28/metaprogramming-ruby/pulse">
    <svg aria-hidden="true" class="octicon octicon-pulse" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M11.5 8L8.8 5.4 6.6 8.5 5.5 1.6 2.38 8H0v2h3.6l.9-1.8.9 5.4L9 8.5l1.6 1.5H14V8z"></path></svg>
    Pulse
</a>
  <a href="https://github.com/elite28/metaprogramming-ruby/graphs" class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors /elite28/metaprogramming-ruby/graphs">
    <svg aria-hidden="true" class="octicon octicon-graph" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"></path></svg>
    Graphs
</a>

</nav>

  </div>
</div><div class="container new-discussion-timeline experiment-repo-nav">
  <div class="repository-content">

    

<a href="https://github.com/elite28/metaprogramming-ruby/blob/5d6c7f02a7d8ea12fd08f286606c73b464ab04b1/zh/02-metaprogramming-ruby/02-Tuesday-Methods/2.2-Dynamic-Methods.markdown" class="hidden js-permalink-shortcut" data-hotkey="y">Permalink</a>

<!-- blob contrib key: blob_contributors:v21:030659c5ae259303ee04e5e06caa96d5 -->

<div class="file-navigation js-zeroclipboard-container has-zeroclipboard-disabled">
  
<div class="select-menu branch-select-menu js-menu-container js-select-menu left">
  <button class="btn btn-sm select-menu-button js-menu-target css-truncate" data-hotkey="w" title="master" type="button" aria-label="Switch branches or tags" tabindex="0" aria-haspopup="true">
    <i>Branch:</i>
    <span class="js-select-button css-truncate-target">master</span>
  </button>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax="" aria-hidden="true">

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <svg aria-label="Close" class="octicon octicon-x js-menu-close" height="16" role="img" version="1.1" viewBox="0 0 12 16" width="12"><path d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"></path></svg>
        <span class="select-menu-title">Switch branches/tags</span>
      </div>

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input aria-label="Filter branches/tags" id="context-commitish-filter-field" class="form-control js-filterable-field js-navigation-enable" placeholder="Filter branches/tags" type="text">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="branches" data-filter-placeholder="Filter branches/tags" class="js-select-menu-tab" role="tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="tags" data-filter-placeholder="Find a tag…" class="js-select-menu-tab" role="tab">Tags</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches" role="menu">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <a class="select-menu-item js-navigation-item js-navigation-open selected" href="#" data-name="master" data-skip-pjax="true" rel="nofollow">
              <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z"></path></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text" title="master">
                master
              </span>
            </a>
        </div>

          <div class="select-menu-no-results">Nothing to show</div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div>

    </div>
  </div>
</div>

  <div class="btn-group right">
    <a href="https://github.com/elite28/metaprogramming-ruby/find/master" class="js-pjax-capture-input btn btn-sm" data-pjax="" data-hotkey="t">
      Find file
    </a>
    
  </div>
  <div class="breadcrumb js-zeroclipboard-target">
    <span class="repo-root js-repo-root"><span class="js-path-segment"><a href="https://github.com/elite28/metaprogramming-ruby"><span>metaprogramming-ruby</span></a></span></span><span class="separator">/</span><span class="js-path-segment"><a href="https://github.com/elite28/metaprogramming-ruby/tree/master/zh"><span>zh</span></a></span><span class="separator">/</span><span class="js-path-segment"><a href="https://github.com/elite28/metaprogramming-ruby/tree/master/zh/02-metaprogramming-ruby"><span>02-metaprogramming-ruby</span></a></span><span class="separator">/</span><span class="js-path-segment"><a href="https://github.com/elite28/metaprogramming-ruby/tree/master/zh/02-metaprogramming-ruby/02-Tuesday-Methods"><span>02-Tuesday-Methods</span></a></span><span class="separator">/</span><strong class="final-path">2.2-Dynamic-Methods.markdown</strong>
  </div>
</div>



  <div class="commit-tease">
      <span class="right">
        <a class="commit-tease-sha" href="https://github.com/elite28/metaprogramming-ruby/commit/5d6c7f02a7d8ea12fd08f286606c73b464ab04b1" data-pjax="">
          5d6c7f0
        </a>
        <relative-time title="Wed 27 Apr 2011 08:10:27 PM HKT" datetime="2011-04-27T12:10:27Z">on Apr 27, 2011</relative-time>
      </span>
      <div>
        <img alt="@elite28" class="avatar" src="347701.dat" width="20" height="20">
        <a href="https://github.com/elite28" class="user-mention" rel="author">elite28</a>
          <a href="https://github.com/elite28/metaprogramming-ruby/commit/5d6c7f02a7d8ea12fd08f286606c73b464ab04b1" class="message" data-pjax="true" title="2.2开始翻译">2.2开始翻译</a>
      </div>

    <div class="commit-tease-contributors">
      <button type="button" class="btn-link muted-link contributors-toggle" data-facebox="#blob_contributors_box">
        <strong>1</strong>
         contributor
      </button>
      
    </div>

    <div id="blob_contributors_box" style="display: none;">
      <h2 class="facebox-header" data-facebox-id="facebox-header">Users who have contributed to this file</h2>
      <ul class="facebox-user-list" data-facebox-id="facebox-description">
          <li class="facebox-user-list-item">
            <img alt="@elite28" src="347701_001.dat" width="24" height="24">
            <a href="https://github.com/elite28">elite28</a>
          </li>
      </ul>
    </div>
  </div>

<div class="file">
  <div class="file-header">
  <div class="file-actions">

    <div class="btn-group">
      <a href="https://github.com/elite28/metaprogramming-ruby/raw/master/zh/02-metaprogramming-ruby/02-Tuesday-Methods/2.2-Dynamic-Methods.markdown" class="btn btn-sm " id="raw-url">Raw</a>
        <a href="https://github.com/elite28/metaprogramming-ruby/blame/master/zh/02-metaprogramming-ruby/02-Tuesday-Methods/2.2-Dynamic-Methods.markdown" class="btn btn-sm js-update-url-with-hash">Blame</a>
      <a href="https://github.com/elite28/metaprogramming-ruby/commits/master/zh/02-metaprogramming-ruby/02-Tuesday-Methods/2.2-Dynamic-Methods.markdown" class="btn btn-sm " rel="nofollow">History</a>
    </div>


        <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="https://github.com/elite28/metaprogramming-ruby/edit/master/zh/02-metaprogramming-ruby/02-Tuesday-Methods/2.2-Dynamic-Methods.markdown" class="inline-form js-update-url-with-hash" data-form-nonce="84da46a5ca5dc665232f8b3d18ab77c9d7b5d735" method="post"><div style="margin: 0px; padding: 0px; display: inline;"><input name="utf8" value="✓" type="hidden"><input name="authenticity_token" value="uFM8MK4sGyAydfRm/YOJ9udzj80O4/xwaC6T2Nw+HJlLx+D6FPknSPmW35XOhVsPwZA/dpvvIc3X+QNpuadxhQ==" type="hidden"></div>
          <button class="btn-octicon tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and edit the file" data-hotkey="e" data-disable-with="">
            <svg aria-hidden="true" class="octicon octicon-pencil" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"></path></svg>
          </button>
</form>        <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="https://github.com/elite28/metaprogramming-ruby/delete/master/zh/02-metaprogramming-ruby/02-Tuesday-Methods/2.2-Dynamic-Methods.markdown" class="inline-form" data-form-nonce="84da46a5ca5dc665232f8b3d18ab77c9d7b5d735" method="post"><div style="margin: 0px; padding: 0px; display: inline;"><input name="utf8" value="✓" type="hidden"><input name="authenticity_token" value="vr2HNHud4Oy5GzPlODH/Nt/HmktDShmuk6rQqqFZc37F6ZOxlKyUFoLvuW97wjmk+lJdx0NygXqk2sFMHkxxyg==" type="hidden"></div>
          <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and delete the file" data-disable-with="">
            <svg aria-hidden="true" class="octicon octicon-trashcan" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"></path></svg>
          </button>
</form>  </div>

  <div class="file-info">
      260 lines (180 sloc)
      <span class="file-info-divider"></span>
    15 KB
  </div>
</div>

  
  <div id="readme" class="readme blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="text"><h2><a id="user-content-22-动态方法" class="anchor" href="#22-动态方法" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.2 动态方法</h2>

<p>Where you learn how to call and define methods dynamically and remove the duplicated code.
教你如何动态地调用和定义方法从而避免代码的冗余。</p>

<p>“As I mentioned, we can remove the duplication in our code with either Dynamic Methods or method_missing(),” Bill recalls. “Forget about method_missing( ) for now—we’ll get to that this afternoon. To introduce Dynamic Methods, allow me to tell you a story from my youth,” he says.</p>

<p>“正如我所说，我们可以通过动态方法或者method_missing()来解决这里的代码冗余。”比尔重复道。“先把method_missing()放到一边，我们下午再研究它。在入手动态方法之前，先听我说一个我年轻时候的段子。”他说。</p>

<p>“When I was a young developer learning C++,” Bill muses, “my mentors told me that when you call a method, you’re actually sending a message to an object. It took me a while to get used to that concept. Of course, if I’d been using Ruby back then, that notion of sending messages would have come more naturally to me.” Bill launches into a mini-presentation.</p>

<p>“当我还年轻的时候，我用C++做开发，”比尔如有所思，“我的导师告诉我，当你调用一个方法时，你实际上是给一个对象发送一个消息。当时我接受并且习惯这个概念花了一段时间。当然，如果我当时一直使用Ruby做开发的话，这个概念接受会更自然些。”比尔发表了个小型演讲。</p>

<p><strong>Calling Methods Dynamically</strong>
<strong>动态方法调用</strong></p>

<p>When you call a method, you usually do so using the standard dot notation:
你通常会使用一个标准的点(.)来调用一个方法：</p>

<pre><code>class MyClass 
  def my_method(my_arg)
    my_arg * 2
  end 
end

obj = MyClass.new 
obj.my_method(3) # =&gt; 6
</code></pre>

<p>Bill demonstrates how you can also call MyClass#my_method() using Object#send() in place of the dot notation:
比尔示范了如何不用点而使用Object#send()方式来调用MyClass#my_method()方法：</p>

<pre><code>obj.send(:my_method, 3) # =&gt; 6
</code></pre>

<p>The previous code still calls my_method( ), but it does so through send( ). The first argument to send( ) is the message that you’re sending to the object—that is, the name of a method. You can use a string or a symbol, but symbols are considered more kosher (see the sidebar on the next page). Any remaining arguments (and the block, if one exists) are simply passed on to the method.</p>

<p>上面的代码仍然是调用my_method()方法，但是它是通过send()方式。传递给send()的第一个参数是你发送消息所接收的对象，也就是方法的名称。你可以使用一个字符串或符号，但通常符号是一个更好的选择（参见下页侧栏）。其他参数（和块（block），如果有的话）都是传递给方法的。</p>

<p>“Wait a minute,” you interject. “Why on Earth would I use send( ) instead of the plain old dot notation?” Bill is glad you asked, pointing out that this is one of the cool things about Ruby. With send( ), the name of the method that you want to call becomes just a regular argument. You can wait literally until the very last moment to decide which method to call, while the code is running. This technique is called Dynamic Dispatch, and you’ll find it wildly useful. To help reveal its magic, Bill shows you a couple of real-life examples.</p>

<p>“等一下，为什么要使用send()而不用以前的.来调用方法呢？”，你问道，比尔很高兴你这么问，这是Ruby语言中一个很酷的东东。用send()方式，方法名成了一个普通的参数，在代码运行的时候，你完全可以在最后时刻决定调用哪个方法。这就是动态方法调用，你慢慢的会发现它是非常有用的。为了让你深入体会动态方法调用的魔力，比尔决定给你看一个生活中的小例子。</p>

<p><strong>The Camping Example</strong></p>

<p>One example of Dynamic Dispatch comes from Camping, a minimalist Ruby web framework. A Camping application stores its configuration parameters as key-value pairs in a file created with YAML, a simple and very popular serialization format.1</p>

<blockquote>
<p>符号（Symbols）</p>

<p>只要你在一个字符串前加一个冒号前缀，那么它就变成了一个符号：</p>

<pre><code>x = :this_is_a_symbol
</code></pre>

<p>符号和字符串类型没有任何关系，他们分别属于不同的类。然而，对于Ruby的初学者来说经常将二者混淆。他们经常会问的一个问题是“符号到底有什么不同的地方？为什么不在所有的地方都使用正常的字符串呢？”</p>

<p>对于这个问题不同的人会给出不同的回答。有些人可能会指出符号不同于字符串的地方在于符号是不可变的：你可以修改一个字符串中的字符，但是你不能对符号进行同样的操作。另外，对于某些操作（譬如比较）来说，使用符号会比使用字符串速度更快。但是，选择使用符号还是字符串主要还是取决于惯例。在大多数情况下，符号会用作某个具体东西的名称，或者是元程序相关东西的名称，譬如方法名。</p>

<p>举例来说，当你使用Object#send()方式调用一个方法时，你需要将方法名作为第一个参数。虽然send()方式对于符号或者字符串的方法名都可以接受，但是传递一个符号作为方法名是最合适的：</p>

<pre><code># 不推荐: 1.send("+", 2) 
1.send(:+, 2)   # =&gt; 3
</code></pre>

<p>不管怎样，你可以很轻易的将符号和字符串进行转换。字符串转换成符号（调用String#to_sym()或者String#intern()方法），符号转换成字符串（调用Symbol#to_s或者Symbol#id2name()）。</p>
</blockquote>

<p>The configuration file for a blog application might look like this:</p>

<pre><code>admin : Bill
title : Rubyland
topic : Ruby and more
</code></pre>

<p>Camping copies keys and values from the file into its own configuration object. (This object is an OpenStruct. You can read more about this class in Section 2.3, The OpenStruct Example, on page 75.) Assume that you store your application’s configuration in a conf object. In an ideal world, the configuration code for the blog application would look like this:</p>

<pre><code>conf.admin = 'Bill' 
conf.title = 'Rubyland' 
conf.topic = 'Ruby and more'
</code></pre>

<p>The sad fact is, in real life, Camping’s source can’t contain this kind of code. That’s because it can’t know in advance which keys you need in your specific application—so it can’t know which methods it’s supposed to call. It can discover the keys you need only at runtime, by parsing the YAML file. For this reason, Camping resorts to Dynamic Dispatch. For each key-value pair, it composes the name of an assignment method, such as admin=( ), and sends the method to conf:</p>

<pre><code># Load configuration if any
if conf.rc and File.exists?( conf.rc ) 
  YAML.load_file(conf.rc).each do |k,v|
    conf.send("#{k}=", v)
  end 
end
</code></pre>

<p>Neat, huh?</p>

<p><strong>The Test::Unit Example</strong></p>

<p>Another example of Dynamic Dispatch (64) comes from the Test::Unit standard library. Test::Unit uses a naming convention to decide which methods are tests. A TestCase looks inside its own public methods and selects the methods that have names starting with test:</p>

<pre><code>method_names = public_instance_methods(true) 
tests = method_names.delete_if {|method_name| method_name !~ /^test./}
</code></pre>

<p>Now TestCase has an array of all test methods. Later, it uses send( ) to call each method in the array.2 This particular flavor of Dynamic Dispatch is sometimes called Pattern Dispatch, because it filters methods based on a pattern in their names.</p>

<blockquote>
<p>Privacy Matters</p>

<p>Remember what Spiderman’s uncle used to say? “With great power comes great responsibility.” The Object#send() method is very powerful—perhaps too powerful. In particular, you can call any method with send( ), including private methods. Short of using a Context Probe (105), this is the easiest way to peek into an object’s private matters.</p>

<p>Some Rubyists think that send( ) makes it too easy to unwillingly break encapsulation. Ruby 1.9 experimented with changing send( )’s behavior, but the changes were ultimately reverted. As of Ruby 1.9.1, send( ) can still call private methods—and many libraries use it just for that purpose. On the other hand, you have a new public_send() method that respects the receiver’s privacy.</p>
</blockquote>

<p>Bill leans back in his chair. “Now you know about send( ) and Dynamic Dispatch, but there is more to Dynamic Methods than that. You’re not limited to calling methods dynamically. You can also define methods dynamically. I’ll show you how.”</p>

<p><strong>Defining Methods Dynamically</strong></p>

<p>You can define a method on the spot with Module#define_method( ). You just need to provide a method name and a block, which becomes the method body:</p>

<pre><code>class MyClass 
  define_method :my_method do |my_arg|
    my_arg * 3
  end 
end

obj = MyClass.new 
obj.my_method(2) # =&gt; 6
</code></pre>

<p>define_method( ) is executed within MyClass, so my_method( ) is defined as an instance method of MyClass.3 This technique of defining a method at runtime is called a Dynamic Method.</p>

<p>You learned how to use Module#define_method( ) in place of the def key- word to define a method and how to use send( ) in place of the dot nota- tion to call a method. Now you can go back to your and Bill’s original problem and put this knowledge to work.</p>

<p><strong>Refactoring the Computer Class</strong></p>

<p>Recall the code that pulled you and Bill into this dynamic discussion:</p>

<pre><code>class Computer 
  def initialize(computer_id, data_source)
    @id = computer_id
    @data_source = data_source
  end

  def mouse 
    info = @data_source.get_mouse_info(@id) 
    price = @data_source.get_mouse_price(@id)
    result = "Mouse: #{info} ($#{price})"
    return "* #{result}" if price &gt;= 100
    result
  end

  def cpu
    info = @data_source.get_cpu_info(@id)
    price = @data_source.get_cpu_price(@id)
    result = "Cpu: #{info} ($#{price})"
    return "* #{result}" if price &gt;= 100
    result
  end

  def keyboard
    info = @data_source.get_keyboard_info(@id) 
    price = @data_source.get_keyboard_price(@id)
    result = "Keyboard: #{info} ($#{price})"
    return "* #{result}" if price &gt;= 100
    result
  end

  # ...
end
</code></pre>

<p>Now that you know about send( ) and define_method( ), you and Bill can get to work and remove the duplication in Computer. Time to refactor!</p>

<p><strong>Step 1: Adding Dynamic Dispatches</strong></p>

<p>You and Bill start, extracting the duplicated code into its own message- sending method:</p>

<pre><code>class Computer 
  def initialize(computer_id, data_source)
    @id = computer_id
    @data_source = data_source
  end

  def mouse 
    component :mouse
  end

  def cpu 
    component :cpu
  end

  def keyboard 
    component :keyboard
  end

  def component(name) 
    info = @data_source.send "get_#{name}_info", @id 
    price = @data_source.send "get_#{name}_price", @id 
    result = "#{name.to_s.capitalize}: #{info} ($#{price})" 
    return "* #{result}" if price &gt;= 100 
    result
  end 
end
</code></pre>

<p>A call to mouse() is delegated to component(), which in turn calls DS# get_mouse_info( ) and DS#get_mouse_price( ). The call also writes the cap- italized name of the component in the resulting string. (Since compo- nent( ) expects the name as a symbol, it converts the symbol to a string with Symbol#to_s().) You open an irb session and smoke-test the new Computer:</p>

<pre><code>my_computer = Computer.new(42, DS.new) 
my_computer.cpu # =&gt; * Cpu: 2.16 Ghz ($220)
</code></pre>

<p>This new version of Computer is a step forward, because it contains far fewer duplicated lines, but you still have to write dozens of similar methods. To avoid writing all those methods, use define_method( ).</p>

<p><strong>Step 2: Generating Methods Dynamically</strong></p>

<p>You and Bill refactor Computer to use define_method( ):</p>

<pre><code>class Computer 
  def initialize(computer_id, data_source)
    @id = computer_id
    @data_source = data_source
  end

  def self.define_component(name) 
    define_method(name) {
      info = @data_source.send "get_#{name}_info", @id 
      price = @data_source.send "get_#{name}_price", @id 
      result = "#{name.to_s.capitalize}: #{info} ($#{price})" 
      return "* #{result}" if price &gt;= 100 
      result
    }
  end

  define_component :mouse
  define_component :cpu 
  define_component :keyboard
end
</code></pre>

<p>Note that define_method( ) is executed inside the definition of Computer, where Computer is the implicit self.4 This means you’re calling define_component( ) on Computer, so it must be a class method.</p>

<p>You quickly test the slimmed-down Computer class in irb and discover that it still works. This is great news!</p>

<p><strong>Step 3: Sprinkling the Code with Introspection</strong></p>

<p>The latest Computer contains minimal duplication, but you can push it even further and remove the duplication altogether. How? By getting rid of all the define_component( ) methods. You can do that by introspecting the data_source argument and extracting the names of all components:</p>

<pre><code>class Computer 
  def initialize(computer_id, data_source)
    @id = computer_id 
    @data_source = data_source data_source.methods.grep(/^get_(.*)_info$/) {Computer.define_component $1 }
  end

  def self.define_component(name)
    define_method(name) {
      info = @data_source.send "get_#{name}_info", @id
      price = @data_source.send "get_#{name}_price", @id
      result = "#{name.capitalize}: #{info} ($#{price})"
      return "* #{result}" if price &gt;= 100
      result
    }
  end
end
</code></pre>

<p>The new line in initialize() is where the magic happens. To understand it, you need to know a couple of things. First, if you pass a block to String#grep(), the block is evaluated for each element that matches the regular expression. Second, the string matching the parenthesized part of the regular expression is stored in the global variable $1. So, if data_source has methods named get_cpu_info() and get_mouse_info(), this code ultimately calls Computer.define_component() twice, with the strings "cpu" and "mouse". Note that you’re calling define_component() with a string rather than a symbol, so you don’t need to convert the argument to string.</p>

<p>The duplicated code is finally gone for good. As a bonus, you don’t even have to write or maintain the list of components. If someone adds a new component to DS, the Computer class will support it automatically. Wonderful!</p>

<p><strong>Let’s Try That Again!</strong></p>

<p>Your refactoring was a resounding success, but Bill is not willing to stop here. “We said that we were going to try two different solutions to this problem, remember? We’ve only found one, involving Dynamic Dispatch (64) and Dynamic Methods (68).” Although it has served the two of you well, to be fair, you need to give the other solution a chance.</p>

<p>“For this second solution,” Bill continues, “we need to talk about some strange methods that are not really methods and a very special method named method_missing( ).”</p>
</article>
  </div>

</div>

<button type="button" data-facebox="#jump-to-line" data-facebox-class="linejump" data-hotkey="l" class="hidden">Jump to Line</button>
<div id="jump-to-line" style="display: none;">
  <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="" class="js-jump-to-line-form" method="get"><div style="margin: 0px; padding: 0px; display: inline;"><input name="utf8" value="✓" type="hidden"></div>
    <input class="form-control linejump-input js-jump-to-line-field" placeholder="Jump to line…" aria-label="Jump to line" autofocus="" type="text">
    <button type="submit" class="btn">Go</button>
</form></div>

  </div>
  <div class="modal-backdrop js-touch-events"></div>
</div></div>
  </div>

    </div>

        <div class="container site-footer-container">
  <div class="site-footer" role="contentinfo">
    <ul class="site-footer-links right">
        <li><a href="https://github.com/contact" data-ga-click="Footer, go to contact, text:contact">Contact GitHub</a></li>
      <li><a href="https://developer.github.com/" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li><a href="https://training.github.com/" data-ga-click="Footer, go to training, text:training">Training</a></li>
      <li><a href="https://shop.github.com/" data-ga-click="Footer, go to shop, text:shop">Shop</a></li>
        <li><a href="https://github.com/blog" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a href="https://github.com/about" data-ga-click="Footer, go to about, text:about">About</a></li>

    </ul>

    <a href="https://github.com/" aria-label="Homepage" class="site-footer-mark" title="GitHub">
      <svg aria-hidden="true" class="octicon octicon-mark-github" height="24" version="1.1" viewBox="0 0 16 16" width="24"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>
    <ul class="site-footer-links">
      <li>© 2016 <span title="0.11224s from github-fe128-cp1-prd.iad.github.net">GitHub</span>, Inc.</li>
        <li><a href="https://github.com/site/terms" data-ga-click="Footer, go to terms, text:terms">Terms</a></li>
        <li><a href="https://github.com/site/privacy" data-ga-click="Footer, go to privacy, text:privacy">Privacy</a></li>
        <li><a href="https://github.com/security" data-ga-click="Footer, go to security, text:security">Security</a></li>
        <li><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a href="https://help.github.com/" data-ga-click="Footer, go to help, text:help">Help</a></li>
    </ul>
  </div>
</div>



    

    <div id="ajax-error-message" class="ajax-error-message flash flash-error">
      <svg aria-hidden="true" class="octicon octicon-alert" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8.865 1.52c-.18-.31-.51-.5-.87-.5s-.69.19-.87.5L.275 13.5c-.18.31-.18.69 0 1 .19.31.52.5.87.5h13.7c.36 0 .69-.19.86-.5.17-.31.18-.69.01-1L8.865 1.52zM8.995 13h-2v-2h2v2zm0-3h-2V6h2v4z"></path></svg>
      <button type="button" class="flash-close js-flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
        <svg aria-hidden="true" class="octicon octicon-x" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"></path></svg>
      </button>
      Something went wrong with that request. Please try again.
    </div>


      
      
      
      
      
      
      
      
      
    <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner hidden">
      <svg aria-hidden="true" class="octicon octicon-alert" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M8.865 1.52c-.18-.31-.51-.5-.87-.5s-.69.19-.87.5L.275 13.5c-.18.31-.18.69 0 1 .19.31.52.5.87.5h13.7c.36 0 .69-.19.86-.5.17-.31.18-.69.01-1L8.865 1.52zM8.995 13h-2v-2h2v2zm0-3h-2V6h2v4z"></path></svg>
      <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="#">Reload</a> to refresh your session.</span>
      <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="#">Reload</a> to refresh your session.</span>
    </div>
    <div class="facebox" id="facebox" style="display: none;">
  <div class="facebox-popup">
    <div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
    </div>
    <button type="button" class="facebox-close js-facebox-close" aria-label="Close modal">
      <svg aria-hidden="true" class="octicon octicon-x" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"></path></svg>
    </button>
  </div>
</div>

  


</body>
</html>
